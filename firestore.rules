rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // 1. 【生体資産ボルト】完全なブラインド・ボルト
    match /voice_assets/{document} {
      allow create: if true;
      allow read, update, delete: if false; 
    }
    
    // 2. 【診断結果】IDを知っている者のみが閲覧可能
    match /results/{id} {
      allow create: if true;
      allow read: if true; 
      allow update, delete: if false; 
    }

    // 3. 【サブスクリプション】ユーザーハッシュに基づくステータス確認
    match /subscriptions/{userHash} {
      allow read: if true;
      allow write: if false; // 書き込みはサーバー（Webhook）側からのみ実行
    }

    // デフォルトはすべて禁止
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
